# Gushen AI - å·¥ç¨‹ä¸æ•°æ®ç»“æ„è®¾è®¡ (ERD)

### ç‰ˆæœ¬å†å²
| ç‰ˆæœ¬ | æ—¥æœŸ       | ä½œè€… | å˜æ›´å†…å®¹                               |
| :--- | :--------- | :--- | :------------------------------------- |
| V1.3 | 2025-01-XX | AI   | å®Œå–„å­—æ®µå•ä½æ ‡è¯†è§„èŒƒ, ç™¾åˆ†æ¯”åŠ "%", æˆäº¤é‡æ”¹ä¸º"ä¸‡æ‰‹" |
| V1.2 | 2024-12-27 | AI   | é‡æ„æ•°æ®æ¸…æ´—è§„èŒƒ, æ–°å¢ç³»ç»ŸåŒ–æ¸…æ´—æ ‡å‡†    |
| V1.1 | 2024-07-25 | AI   | ç§»é™¤Scheduler, ç§»é™¤å¼ºåº¦åˆ†, æ›´æ–°æ•°æ®ç»“æ„ |
| V1.0 | 2024-07-25 | AI   | åˆç‰ˆåˆ›å»º                               |

---

## 1. ç³»ç»Ÿæ¶æ„ (System Architecture)

æœ¬ç³»ç»Ÿå°†é‡‡ç”¨æ¨¡å—åŒ–çš„æ‰‹åŠ¨è§¦å‘æµæ°´çº¿æ¶æ„ï¼Œç¡®ä¿å„éƒ¨åˆ†èŒè´£æ¸…æ™°ã€æ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚

```mermaid
graph TD
    A[Manual Trigger] --> B[DataFetcher];
    B --> C1[top_list.csv];
    B --> C2[top_data.csv];
    B --> C3[hm_list.csv];
    B --> C4[daily_data.csv];

    subgraph Data Processing Pipeline
        C1 --> D[DataProcessor];
        C2 --> D;
        C3 --> D;
        C4 --> D;
        D -- Processed Data --> E[AnalysisEngine];
    end

    subgraph Analysis Engine
        E --> F[SeatProfiler];
        E --> G[HistoryAnalyzer];
    end

    F -- Seat Profiles --> H[LLM_Interpreter];
    G -- Historical Context --> H;
    D -- Processed Data --> H;

    H -- Generated Content --> I[PostGenerator];
    I -- Structured Post --> J[Output: JSON/DB];

```

### 1.1. æ ¸å¿ƒæ¨¡å—æ‹†è§£

1.  **DataFetcher**:
    - **èŒè´£**: è´Ÿè´£ä»å„ç§æ•°æ®æºè·å–åŸå§‹æ•°æ®ï¼ˆè°ƒå–tushare apiï¼‰ã€‚
    - **å®ç°**: ç¼–å†™ç‹¬ç«‹çš„Pythonè„šæœ¬æˆ–å‡½æ•°ï¼Œç”¨äºè¯»å–CSVæ–‡ä»¶ã€‚
2.  **DataProcessor**:
    - **èŒè´£**: å¯¹åŸå§‹æ•°æ®è¿›è¡Œæ¸…æ´—ã€æ ¼å¼åŒ–ã€åˆå¹¶ã€‚ä¾‹å¦‚ï¼Œå°†ä¸åŒæ–‡ä»¶ä¸­çš„æ•°æ®æŒ‰è‚¡ç¥¨ä»£ç å’Œæ—¥æœŸå¯¹é½ã€‚
    - **è¾“å‡º**: ç”Ÿæˆæ ‡å‡†åŒ–çš„ã€å¯ä¾›ä¸‹æ¸¸åˆ†æçš„DataFrameæˆ–JSONå¯¹è±¡ã€‚
3.  **SeatProfiler (å¸­ä½ç”»åƒ)**:
    - **èŒè´£**: å…³è”`hm_list.csv`ï¼Œè¯†åˆ«å¸­ä½èº«ä»½å’Œé£æ ¼ã€‚
    - **è¾“å…¥**: `top_data.csv`ä¸­çš„è¥ä¸šéƒ¨åç§°ã€‚
    - **è¾“å‡º**: ä¸ºæ¯ä¸ªå¸­ä½é™„åŠ èº«ä»½æ ‡ç­¾å’Œé£æ ¼ã€‚
4.  **HistoryAnalyzer (å†å²åˆ†æ)**:
    - **èŒè´£**: å…³è”`daily_data.csv`ï¼Œä¸ºæ¯åªä¸Šæ¦œè‚¡ç¥¨æ ‡æ³¨å†å²é¾™è™æ¦œè®°å½•ï¼Œç”Ÿæˆå†å²è¡Œä¸ºåˆ†ææ‰€éœ€çš„æ•°æ®è§†å›¾ã€‚
    - **è¾“å…¥**: ä¸Šæ¦œè‚¡ç¥¨ä»£ç ã€æ—¥æœŸèŒƒå›´ã€‚
    - **è¾“å‡º**: åŒ…å«Kçº¿å’Œä¸Šæ¦œæ ‡è®°çš„æ•°æ®é›†ã€‚
5.  **LLM_Interpreter (AIè§£è¯»å¼•æ“)**:
    - **èŒè´£**: æ ¸å¿ƒAIæ¨¡å—ã€‚æ¥æ”¶æ‰€æœ‰å¤„ç†å¥½çš„æ•°æ®ï¼Œé€šè¿‡ç²¾å¿ƒè®¾è®¡çš„Promptï¼Œè°ƒç”¨å¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆæ‰€æœ‰æ–‡æœ¬å†…å®¹ã€‚
    - **è¾“å‡º**: ç»“æ„åŒ–çš„æ–‡æœ¬ï¼ŒåŒ…æ‹¬æ ¸å¿ƒæ‘˜è¦ã€æˆ˜å±€è§£è¯»ã€åå¸‚æ¨æ¼”ç­‰ã€‚
6.  **PostGenerator (å¸–å­ç”Ÿæˆå™¨)**:
    - **èŒè´£**: å°†LLMç”Ÿæˆçš„æ–‡æœ¬å†…å®¹ä¸ç»“æ„åŒ–æ•°æ®ç»„è£…æˆæœ€ç»ˆçš„å¸–å­æ ¼å¼ã€‚
    - **è¾“å‡º**: ä¸€ä¸ªå®Œæ•´çš„ã€å¯ä¾›å‘å¸ƒåˆ°å‰ç«¯æˆ–æ•°æ®åº“çš„JSONå¯¹è±¡ã€‚

### 1.2. V2 æ¶æ„è®¾æƒ³ (äº¤äº’å¼æŸ¥è¯¢)
```mermaid
graph TD
    subgraph V1 Static Pipeline
        A[Manual Trigger] --> B[DataFetcher];
        B --> D[DataProcessor];
        D --> H[LLM_Interpreter];
        H --> J[Post DB];
    end

    subgraph V2 Interactive Loop
        K[User Frontend] -- User Question --> L[API Endpoint];
        L -- StockID, Question --> M[Interactive_LLM_Agent];
        J -- Fetches Context by StockID --> M;
        M -- Generated Answer --> L;
        L --> K;
    end
```

## 1.3. é¡¹ç›®æ¶æ„ (Project Architecture)

### 1.3.1. é¡¹ç›®ç›®å½•ç»“æ„

```
dragon & tiger/
â”œâ”€â”€ ğŸ“ core/                          # æ ¸å¿ƒä¸šåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ data_fetcher.py               # âœ… æ•°æ®è·å–å™¨ (å·²å®Œæˆ)
â”‚   â”œâ”€â”€ data_processor.py             # âœ… æ•°æ®å¤„ç†å™¨ (å·²å®Œæˆ)  
â”‚   â”œâ”€â”€ seat_profiler.py              # ğŸ”„ å¸­ä½ç”»åƒåˆ†æå™¨ (å¼€å‘ä¸­)
â”‚   â”œâ”€â”€ history_analyzer.py           # â³ å†å²åˆ†æå¼•æ“ (å¾…å¼€å‘)
â”‚   â”œâ”€â”€ llm_interpreter.py            # â³ AIè§£è¯»å¼•æ“ (å¾…å¼€å‘)
â”‚   â””â”€â”€ post_generator.py             # â³ å¸–å­ç”Ÿæˆå™¨ (å¾…å¼€å‘)
â”‚
â”œâ”€â”€ ğŸ“ data/                          # æ•°æ®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ raw/                          # åŸå§‹æ•°æ®
â”‚   â”‚   â”œâ”€â”€ top_list.csv              # é¾™è™æ¦œæ—¥æ¦œå•
â”‚   â”‚   â”œâ”€â”€ top_data.csv              # ä¸ªè‚¡å¸­ä½æ•°æ®
â”‚   â”‚   â”œâ”€â”€ hm_list.csv               # æ¸¸èµ„åäººå½•
â”‚   â”‚   â””â”€â”€ daily_data.csv            # æ—¥Kçº¿æ•°æ®
â”‚   â”œâ”€â”€ processed/                    # å¤„ç†åæ•°æ®
â”‚   â”‚   â””â”€â”€ processed_data.json       # æ ‡å‡†åŒ–æ•°æ®è¾“å‡º
â”‚   â””â”€â”€ output/                       # æœ€ç»ˆè¾“å‡º
â”‚       â””â”€â”€ posts/                    # ç”Ÿæˆçš„å¸–å­å†…å®¹
â”‚
â”œâ”€â”€ ğŸ“ config/                        # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ api_config.py                 # APIé…ç½®
â”‚   â”œâ”€â”€ llm_prompts.py                # LLMæç¤ºè¯æ¨¡æ¿
â”‚   â””â”€â”€ business_rules.py             # ä¸šåŠ¡è§„åˆ™é…ç½®
â”‚
â”œâ”€â”€ ğŸ“ utils/                         # å·¥å…·åº“
â”‚   â”œâ”€â”€ logger.py                     # æ—¥å¿—å·¥å…·
â”‚   â”œâ”€â”€ validator.py                  # æ•°æ®éªŒè¯å™¨
â”‚   â””â”€â”€ common.py                     # é€šç”¨å·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ ğŸ“ tests/                         # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ test_data_fetcher.py          # æ•°æ®è·å–æµ‹è¯•
â”‚   â”œâ”€â”€ test_data_processor.py        # æ•°æ®å¤„ç†æµ‹è¯•
â”‚   â””â”€â”€ integration_tests.py          # é›†æˆæµ‹è¯•
â”‚
â”œâ”€â”€ ğŸ“ docs/                          # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ api_reference.md              # APIå‚è€ƒæ–‡æ¡£
â”‚   â”œâ”€â”€ user_guide.md                 # ç”¨æˆ·æŒ‡å—  
â”‚   â””â”€â”€ .cursor/erd.md                # ç³»ç»Ÿæ¶æ„è®¾è®¡æ–‡æ¡£
â”‚
â”œâ”€â”€ ğŸ“ é¾™è™æ¦œç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ/            # äº§å“è®¾è®¡æ–¹æ¡ˆ
â”‚   â”œâ”€â”€ Claude.md                     # Claudeæ–¹æ¡ˆ
â”‚   â”œâ”€â”€ Gemini.md                     # Geminiæ–¹æ¡ˆ
â”‚   â”œâ”€â”€ o3.md                         # O3æ–¹æ¡ˆ
â”‚   â””â”€â”€ prd.md                        # äº§å“éœ€æ±‚æ–‡æ¡£
â”‚
â”œâ”€â”€ requirements.txt                  # Pythonä¾èµ–
â”œâ”€â”€ main.py                          # ä¸»ç¨‹åºå…¥å£
â””â”€â”€ README.md                        # é¡¹ç›®è¯´æ˜
```

### 1.3.2. æ¨¡å—å¼€å‘çŠ¶æ€ä¸æŠ€æœ¯å®ç°

| æ¨¡å—åç§° | å¼€å‘çŠ¶æ€ | æŠ€æœ¯æ ˆ | æ ¸å¿ƒåŠŸèƒ½ | è¾“å…¥ | è¾“å‡º |
|---------|---------|-------|---------|------|------|
| **DataFetcher** | âœ… å·²å®Œæˆ | Python + Tushare API | æ•°æ®è·å–ä¸éªŒè¯ | APIè°ƒç”¨å‚æ•° | æ ‡å‡†åŒ–CSVæ–‡ä»¶ |
| **DataProcessor** | âœ… å·²å®Œæˆ | Python + pandas | æ•°æ®æ¸…æ´—ä¸æ ¼å¼åŒ– | åŸå§‹CSVæ–‡ä»¶ | ç»“æ„åŒ–JSONæ•°æ® |
| **SeatProfiler** | ğŸ”„ å¼€å‘ä¸­ | Python + æ­£åˆ™åŒ¹é… | å¸­ä½èº«ä»½è¯†åˆ« | å¸­ä½åç§° + æ¸¸èµ„åäººå½• | ç©å®¶ç”»åƒæ•°æ® |
| **HistoryAnalyzer** | â³ å¾…å¼€å‘ | Python + numpy | å†å²è¡Œä¸ºåˆ†æ | Kçº¿æ•°æ® + ä¸Šæ¦œè®°å½• | è¶‹åŠ¿åˆ†ææŠ¥å‘Š |
| **LLM_Interpreter** | â³ å¾…å¼€å‘ | Python + OpenAI/Claude API | AIå†…å®¹ç”Ÿæˆ | ç»“æ„åŒ–æ•°æ® + æç¤ºè¯ | æ™ºèƒ½åˆ†ææ–‡æœ¬ |
| **PostGenerator** | â³ å¾…å¼€å‘ | Python + Jinja2 | å†…å®¹ç»„è£…å‘å¸ƒ | åˆ†ææ–‡æœ¬ + æ•°æ® | å®Œæ•´å¸–å­JSON |

### 1.3.3. æŠ€æœ¯æ ˆä¸ä¾èµ–

#### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **åç«¯è¯­è¨€**: Python 3.9+
- **æ•°æ®å¤„ç†**: pandas, numpy, json
- **APIè°ƒç”¨**: tushare, requests  
- **AIæ¨¡å‹**: OpenAI GPT-4 / Anthropic Claude
- **æ—¥å¿—è®°å½•**: Python logging
- **æµ‹è¯•æ¡†æ¶**: pytest

#### å…³é”®ä¾èµ–åŒ…
```python
# requirements.txt æ ¸å¿ƒä¾èµ–
tushare>=1.2.89          # é‡‘èæ•°æ®æ¥å£
pandas>=2.0.0            # æ•°æ®å¤„ç†
numpy>=1.24.0            # æ•°å€¼è®¡ç®—
openai>=1.0.0            # OpenAI API
anthropic>=0.8.0         # Claude API
jinja2>=3.1.0            # æ¨¡æ¿å¼•æ“
pytest>=7.0.0            # æµ‹è¯•æ¡†æ¶
requests>=2.28.0         # HTTPå®¢æˆ·ç«¯
python-dotenv>=1.0.0     # ç¯å¢ƒå˜é‡ç®¡ç†
```

### 1.3.4. æ•°æ®æµè½¬æ¶æ„

```mermaid
graph LR
    subgraph "æ•°æ®å±‚ (Data Layer)"
        A1[Tushare API] --> B1[Raw CSV Files]
        B1 --> C1[Processed JSON]
        C1 --> D1[Final Posts]
    end

    subgraph "å¤„ç†å±‚ (Processing Layer)"  
        E1[DataFetcher] --> E2[DataProcessor]
        E2 --> E3[SeatProfiler]
        E3 --> E4[HistoryAnalyzer]
        E4 --> E5[LLM_Interpreter]
        E5 --> E6[PostGenerator]
    end

    subgraph "æ§åˆ¶å±‚ (Control Layer)"
        F1[Manual Trigger] --> F2[Main Pipeline]
        F2 --> F3[Error Handler]
        F3 --> F4[Logger]
    end

    A1 -.-> E1
    E1 -.-> B1
    E2 -.-> C1
    E6 -.-> D1
    F1 -.-> E1
```

### 1.3.5. éƒ¨ç½²æ¶æ„è®¾è®¡

#### V1.0 æœ¬åœ°å¼€å‘æ¶æ„
```mermaid
graph TD
    A[å¼€å‘è€…æœ¬åœ°ç¯å¢ƒ] --> B[Pythonè„šæœ¬æ‰§è¡Œ]
    B --> C[æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ]
    C --> D[CSV/JSONè¾“å‡º]
    
    E[Tushare API] --> B
    F[OpenAI/Claude API] --> B
```

#### V2.0 ç”Ÿäº§éƒ¨ç½²æ¶æ„ (è§„åˆ’)
```mermaid
graph TD
    subgraph "äº‘æœåŠ¡å™¨"
        A[å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨] --> B[æ•°æ®å¤„ç†æœåŠ¡]
        B --> C[æ•°æ®å­˜å‚¨]
        C --> D[Web APIæœåŠ¡]
        D --> E[å‰ç«¯ç•Œé¢]
    end
    
    subgraph "å¤–éƒ¨ä¾èµ–"
        F[Tushare API]
        G[LLM APIæœåŠ¡]
        H[æ•°æ®åº“é›†ç¾¤]
    end
    
    F --> B
    G --> B
    C --> H
```

### 1.3.6. å¼€å‘è·¯çº¿å›¾

#### é˜¶æ®µä¸€ï¼šæ•°æ®åŸºç¡€è®¾æ–½ (å·²å®Œæˆ âœ…)
- [x] æ•°æ®è·å–æ¨¡å— (DataFetcher)
- [x] æ•°æ®å¤„ç†æ¨¡å— (DataProcessor)
- [x] æ•°æ®æ¸…æ´—è§„èŒƒåˆ¶å®š
- [x] åŸºç¡€æµ‹è¯•ç”¨ä¾‹ç¼–å†™

#### é˜¶æ®µäºŒï¼šåˆ†æå¼•æ“å¼€å‘ (å½“å‰é˜¶æ®µ ğŸ”„)
- [ ] å¸­ä½ç”»åƒåˆ†æå™¨ (SeatProfiler)
- [ ] å†å²è¡Œä¸ºåˆ†æå™¨ (HistoryAnalyzer)  
- [ ] æ¸¸èµ„è¯†åˆ«ç®—æ³•ä¼˜åŒ–
- [ ] æŠ€æœ¯æŒ‡æ ‡è®¡ç®—æ¨¡å—

#### é˜¶æ®µä¸‰ï¼šAIå†…å®¹ç”Ÿæˆ (ä¸‹ä¸€é˜¶æ®µ â³)
- [ ] LLMæç¤ºè¯å·¥ç¨‹
- [ ] AIè§£è¯»å¼•æ“ (LLM_Interpreter)
- [ ] å†…å®¹æ¨¡æ¿è®¾è®¡
- [ ] å¸–å­ç”Ÿæˆå™¨ (PostGenerator)

#### é˜¶æ®µå››ï¼šç³»ç»Ÿé›†æˆä¸ä¼˜åŒ– (æœªæ¥è§„åˆ’ ğŸ“‹)
- [ ] ç«¯åˆ°ç«¯æµæ°´çº¿é›†æˆ
- [ ] æ€§èƒ½ä¼˜åŒ–ä¸ç›‘æ§
- [ ] é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶
- [ ] ç”¨æˆ·äº¤äº’ç•Œé¢å¼€å‘

### 1.3.7. è´¨é‡ä¿è¯ä½“ç³»

#### ä»£ç è´¨é‡æ ‡å‡†
- **ç¼–ç è§„èŒƒ**: PEP 8 Pythonç¼–ç æ ‡å‡†
- **æ–‡æ¡£è¦æ±‚**: æ¯ä¸ªæ¨¡å—å¿…é¡»åŒ…å«è¯¦ç»†æ–‡æ¡£å­—ç¬¦ä¸²
- **æµ‹è¯•è¦†ç›–**: æ ¸å¿ƒæ¨¡å—æµ‹è¯•è¦†ç›–ç‡ > 80%
- **ä»£ç å®¡æŸ¥**: å…³é”®æ¨¡å—éœ€è¦è¿›è¡Œä»£ç å®¡æŸ¥

#### æ•°æ®è´¨é‡ä¿è¯
- **æ•°æ®éªŒè¯**: æ¯ä¸ªæ•°æ®å¤„ç†æ­¥éª¤éƒ½åŒ…å«æ•°æ®éªŒè¯
- **å¼‚å¸¸å¤„ç†**: å®Œå–„çš„å¼‚å¸¸æ•è·å’Œå¤„ç†æœºåˆ¶
- **æ—¥å¿—è®°å½•**: è¯¦ç»†çš„å¤„ç†æ—¥å¿—ä¾¿äºé—®é¢˜æ’æŸ¥
- **å›æµ‹éªŒè¯**: å®šæœŸå¯¹åˆ†æç»“æœè¿›è¡Œå›æµ‹éªŒè¯

## 2. æ•°æ®ç»“æ„è®¾è®¡ (Data Schema)

### 2.1. è¾“å…¥æ•°æ®æº (CSV Schemas based on data-test.ipynb)

-   **`hm_list.csv` (æ¸¸èµ„åäººå½•)**
    -   `name` (string): æ¸¸èµ„/æœºæ„åç§° (e.g., "é¾™é£è™")
    -   `desc` (string): é£æ ¼æè¿°
    -   `orgs` (string): å…³è”çš„å¸­ä½åˆ—è¡¨ (e.g., "['åæ³°è¯åˆ¸è‚¡ä»½æœ‰é™å…¬å¸å—äº¬å…­åˆé›„å·è¥¿è·¯è¯åˆ¸è¥ä¸šéƒ¨']")

-   **`top_list.csv` (é¾™è™æ¦œæ¯æ—¥åˆ—è¡¨)**
    -   `trade_date` (string): äº¤æ˜“æ—¥æœŸ (e.g., "20250617")
    -   `ts_code` (string): Tushareä»£ç  (e.g., "000525.SZ")
    -   `name` (string): è‚¡ç¥¨åç§°
    -   `close` (float): æ”¶ç›˜ä»·
    -   `pct_change` (float): æ¶¨è·Œå¹…
    -   `turnover_rate` (float): æ¢æ‰‹ç‡
    -   `amount` (float): æ€»æˆäº¤é¢(å…ƒ)
    -   `l_sell` (float): é¾™è™æ¦œå–å‡ºé¢(å…ƒ)
    -   `l_buy` (float): é¾™è™æ¦œä¹°å…¥é¢(å…ƒ)
    -   `l_amount` (float): é¾™è™æ¦œæ€»æˆäº¤é¢(å…ƒ)
    -   `net_amount` (float): å‡€ä¹°å…¥é¢(å…ƒ)
    -   `net_rate` (float): å‡€ä¹°å…¥å æ¯”(%)
    -   `amount_rate` (float): é¾™è™æ¦œæˆäº¤é¢å æ¯”(%)
    -   `float_values` (float): æµé€šå¸‚å€¼(å…ƒ)
    -   `reason` (string): ä¸Šæ¦œåŸå› 

-   **`top_data.csv` (ä¸ªè‚¡å¸­ä½æ•°æ®, from top_inst API)**
    -   `trade_date` (string): äº¤æ˜“æ—¥æœŸ (e.g., "20250617")
    -   `ts_code` (string): Tushareä»£ç  (e.g., "000525.SZ")
    -   `exalter` (string): è¥ä¸šéƒ¨åç§°
    -   `buy` (float): ä¹°å…¥é¢(å…ƒ)
    -   `buy_rate` (float): ä¹°å…¥å æ€»æˆäº¤æ¯”ä¾‹
    -   `sell` (float): å–å‡ºé¢(å…ƒ)
    -   `sell_rate` (float): å–å‡ºå æ€»æˆäº¤æ¯”ä¾‹
    -   `net_buy` (float): å‡€ä¹°å…¥é¢(å…ƒ)

-   **`daily_data.csv` (æ—¥Kçº¿è¡Œæƒ…)**
    -   `ts_code` (string): Tushareä»£ç 
    -   `trade_date` (string): äº¤æ˜“æ—¥æœŸ
    -   `open`, `high`, `low`, `close` (float): å¼€é«˜ä½æ”¶
    -   `pre_close` (float): æ˜¨æ”¶
    -   `change` (float): æ¶¨è·Œé¢
    -   `pct_chg` (float): æ¶¨è·Œå¹…
    -   `vol` (float): æˆäº¤é‡(æ‰‹)
    -   `amount` (float): æˆäº¤é¢(åƒå…ƒ)




### 2.2. æ•°æ®æ¸…æ´—è§„èŒƒ (Data Cleaning Standards)

#### 2.2.1. å­—æ®µå•ä½è½¬æ¢è§„åˆ™
**ç›®æ ‡**: JSONè¾“å‡ºä¸­çš„æ‰€æœ‰æ•°å€¼å­—æ®µéƒ½å¸¦æœ‰æ˜ç¡®çš„å•ä½æ ‡è¯†

**é‡‘é¢ç±»å­—æ®µè½¬æ¢**:
- **è¾“å…¥å•ä½**: 
  - `top_list.csv`, `top_data.csv`: é‡‘é¢å­—æ®µä¸º"å…ƒ"
  - `daily_data.csv`: `amount`å­—æ®µä¸º"åƒå…ƒ"
- **è½¬æ¢é€»è¾‘**:
  ```
  åŸå§‹å€¼(å…ƒ) -> ç›®æ ‡å•ä½
  < 1,000ä¸‡å…ƒ (10,000,000)  -> ä¸‡å…ƒæ˜¾ç¤º
  â‰¥ 1,000ä¸‡å…ƒ (10,000,000)  -> äº¿å…ƒæ˜¾ç¤º
  ```
- **è½¬æ¢ç¤ºä¾‹**:
  ```
  5,000,000å…ƒ      -> "500.00ä¸‡å…ƒ"
  8,000,000å…ƒ      -> "800.00ä¸‡å…ƒ"
  15,000,000å…ƒ     -> "1,500.00ä¸‡å…ƒ"
  100,000,000å…ƒ    -> "1.00äº¿å…ƒ"
  500,000,000å…ƒ    -> "5.00äº¿å…ƒ"
  ```

**ç‰¹æ®Šå¤„ç† - daily_data.csv amountå­—æ®µ**:
- **è¾“å…¥**: åƒå…ƒ
- **å¤„ç†**: å…ˆè½¬æ¢ä¸ºå…ƒ(`amount * 1000`)ï¼Œå†æŒ‰æ ‡å‡†é€»è¾‘è½¬æ¢
- **ç¤ºä¾‹**: `80,000åƒå…ƒ -> 80,000,000å…ƒ -> "8.00äº¿å…ƒ"`

#### 2.2.2. å„ç±»å­—æ®µæ¸…æ´—è§„èŒƒ

**ä»·æ ¼ç±»å­—æ®µ**:
- **é€‚ç”¨å­—æ®µ**: `close`, `open`, `high`, `low`, `pre_close`
- **è¾“å‡ºæ ¼å¼**: ä¿ç•™ä¸¤ä½å°æ•°ï¼Œä¸æ·»åŠ å•ä½ï¼ˆä¿æŒæ•°å€¼å‹ï¼‰
- **ç¤ºä¾‹**: `9.03`, `12.45` (å…ƒä¸ºé»˜è®¤å•ä½ï¼Œå‰ç«¯æ˜¾ç¤ºæ—¶æ·»åŠ )

**ç™¾åˆ†æ¯”ç±»å­—æ®µ**:
- **é€‚ç”¨å­—æ®µ**: `pct_change`, `pct_chg`, `turnover_rate`, `buy_rate`, `sell_rate`, `net_rate`, `amount_rate`
- **è¾“å‡ºæ ¼å¼**: ä¿ç•™ä¸¤ä½å°æ•°ï¼Œä¸æ·»åŠ å•ä½ï¼ˆä¿æŒæ•°å€¼å‹ï¼‰
- **ç¤ºä¾‹**: `9.99`, `4.46`, `-2.57` (%ä¸ºé»˜è®¤å•ä½ï¼Œå‰ç«¯æ˜¾ç¤ºæ—¶æ·»åŠ )

**æˆäº¤é‡å­—æ®µ**:
- **é€‚ç”¨å­—æ®µ**: `vol` (æˆäº¤é‡-æ‰‹)
- **è¾“å‡ºæ ¼å¼**: ä¿ç•™ä¸¤ä½å°æ•°ï¼Œä¸æ·»åŠ å•ä½ï¼ˆä¿æŒæ•°å€¼å‹ï¼‰
- **ç¤ºä¾‹**: `1099394.41`, `524975.09` (æ‰‹ä¸ºé»˜è®¤å•ä½ï¼Œå‰ç«¯æ˜¾ç¤ºæ—¶æ·»åŠ )

**é‡‘é¢ç±»å­—æ®µè¯¦ç»†æ¸…å•**:
- **top_list.csv**: `amount`, `l_sell`, `l_buy`, `l_amount`, `net_amount`, `float_values`
- **top_data.csv**: `buy`, `sell`, `net_buy`
- **daily_data.csv**: `amount` (éœ€ç‰¹æ®Šå¤„ç†ï¼Œåƒå…ƒ->å…ƒ)
- **è¾“å‡ºæ ¼å¼**: æŒ‰è½¬æ¢é€»è¾‘æ˜¾ç¤ºä¸º`"XX.XXä¸‡å…ƒ"`æˆ–`"XX.XXäº¿å…ƒ"`

#### 2.2.3. æ—¥æœŸæ ¼å¼æ ‡å‡†åŒ–
- **è¾“å…¥æ ¼å¼**: "YYYYMMDD" (e.g., "20250617")
- **å­˜å‚¨æ ¼å¼**: ä¿æŒå­—ç¬¦ä¸²æ ¼å¼ "YYYYMMDD" (ç”¨äºè®¡ç®—å’Œç´¢å¼•)
- **æ˜¾ç¤ºæ ¼å¼**: "YYYY-MM-DD" (e.g., "2025-06-17") (ç”¨äºç”¨æˆ·ç•Œé¢)
- **å®ç°**: æ·»åŠ  `trade_date_display` å­—æ®µ

#### 2.2.4. è¾“å‡ºJSONå­—æ®µå•ä½å¯¹ç…§è¡¨

| å­—æ®µç±»å‹ | å­—æ®µå | è¾“å…¥å•ä½ | è¾“å‡ºæ ¼å¼ | ç¤ºä¾‹ |
|---------|--------|----------|----------|------|
| ä»·æ ¼ | close, open, high, low | å…ƒ | æ•°å€¼å‹(ä¸¤ä½å°æ•°) | 9.03 |
| ç™¾åˆ†æ¯” | pct_change, turnover_rateç­‰ | % | æ•°å€¼å‹(ä¸¤ä½å°æ•°) | 9.99 |
| é‡‘é¢ | amount, l_buy, l_sellç­‰ | å…ƒ | å­—ç¬¦ä¸²å‹(å¸¦å•ä½) | "1,500.00ä¸‡å…ƒ" |
| æˆäº¤é‡ | vol | æ‰‹ | æ•°å€¼å‹(ä¸¤ä½å°æ•°) | 524975.09 |
| æ—¥æœŸæ˜¾ç¤º | trade_date_display | YYYYMMDD | å­—ç¬¦ä¸²å‹ | "2025-06-17" |

#### 2.2.5. æ•°å€¼ç²¾åº¦ç»Ÿä¸€æ ‡å‡†
- **æ‰€æœ‰æ•°å€¼**: ç»Ÿä¸€ä¿ç•™ä¸¤ä½å°æ•°
- **è´Ÿæ•°å¤„ç†**: è´Ÿå·å‰ç½® (e.g., "-1,234.56ä¸‡å…ƒ")
- **é›¶å€¼å¤„ç†**: æ˜¾ç¤ºä¸º "0.00" + å¯¹åº”å•ä½

#### 2.2.6. å®ç°æ–¹æ³•æ˜ å°„

**DataProcessorç±»éœ€è¦å®ç°çš„æ ¼å¼åŒ–æ–¹æ³•**:
- `_format_amount(amount)` -> è¿”å›å¸¦å•ä½çš„é‡‘é¢å­—ç¬¦ä¸²
- `_format_price(price)` -> è¿”å›ä¸¤ä½å°æ•°çš„æ•°å€¼
- `_format_percentage(percentage)` -> è¿”å›ä¸¤ä½å°æ•°çš„æ•°å€¼  
- `_format_date_display(date_str)` -> è¿”å›æ ¼å¼åŒ–æ—¥æœŸå­—ç¬¦ä¸²

**ç‰¹æ®Šå¤„ç†logic**:
- daily_data.csvçš„amountå­—æ®µ: `_format_amount(amount * 1000)`
- å…¶ä»–é‡‘é¢å­—æ®µ: `_format_amount(amount)`
- æ‰€æœ‰ç™¾åˆ†æ¯”å’Œä»·æ ¼å­—æ®µ: ä¿æŒæ•°å€¼å‹ï¼Œç²¾åº¦ä¸¤ä½å°æ•°

### 2.3. è¾“å‡ºæ•°æ®ç»“æ„ (Final Post JSON, V1.1)

```json
{
  "stock_code": "002202",
  "stock_name": "ç¾æ™¨ç§‘æŠ€",
  "date": "2024-07-25",
  "headline_summary": "æ ¸å¿ƒçœ‹ç‚¹ï¼šç¾æ™¨ç§‘æŠ€ä»Šæ—¥é¾™è™æ¦œå‘ˆç°"ä¸€å®¶ç‹¬å¤§"æ ¼å±€ï¼Œ"Nå‘¨äºŒ"å¼ºåŠ¿ä¸»ä¹°ï¼Œå¤šç©ºåšå¼ˆæ¿€çƒˆï¼Œæ˜æ—¥èµ°åŠ¿å……æ»¡å˜æ•°ã€‚",
  "funding_battle_map": {
    "buy_side": {
      "total_amount": 5000,
      "players": [
        {
          "rank": 1,
          "seat_name": "ä¸­ä¿¡è¯åˆ¸è‚¡ä»½æœ‰é™å…¬å¸ä¸Šæµ·åˆ†å…¬å¸",
          "player_name": "Nå‘¨äºŒ",
          "amount": 1641,
          "ai_tag": "åšå¤šæ ¸å¿ƒ"
        }
      ]
    },
    "sell_side": {
      "total_amount": 3000,
      "players": [
        {
          "rank": 1,
          "seat_name": "æœºæ„ä¸“ç”¨",
          "player_name": "æœºæ„ä¸“ç”¨",
          "amount": 1200,
          "ai_tag": "ä¸»è¦ç ¸ç›˜æ–¹"
        }
      ]
    }
  },
  "llm_analysis": {
    "behavior_analysis": "æœ¬æ¬¡ä¸Šæ¦œå±äºå…¸å‹çš„'è¶‹åŠ¿åŠ ä»“'è¡Œä¸º...",
    "battle_summary": "ä»Šå¤©çš„ç‰Œæ¡Œä¸Šï¼Œ'Nå‘¨äºŒ'æ˜¯ç»å¯¹çš„ä¸»è§’...",
    "core_inference": {
      "judgment": "å¤§æ¦‚ç‡å°†è¿›è¡Œéœ‡è¡æ´—ç›˜ã€‚",
      "reasoning": "åŸºäºä¸»åŠ›"Nå‘¨äºŒ"å¿«è¿›å¿«å‡ºçš„äº¤æ˜“é£æ ¼...",
      "next_day_watch": "è§‚å¯Ÿæ¬¡æ—¥è‚¡ä»·æ˜¯å¦èƒ½ç»´æŒåœ¨ä»Šæ—¥æ”¶ç›˜ä»·ä¸Šæ–¹è¿è¡Œ..."
    },
    "qa_section": [
        {
            "question": "ç°åœ¨è¿˜èƒ½è¿½è¿›å»å—ï¼Ÿ",
            "answer": "ã€ç­–ç•¥ã€‘ä»æŠ€æœ¯å½¢æ€çœ‹...ã€é£é™©ã€‘å¦‚æœè·Œç ´XXå…ƒ...ã€åŸç†ã€‘å› ä¸º..."
        },
        {
            "question": "å¦‚æœæˆ‘æ˜å¤©è¿›äº†ï¼Œä»€ä¹ˆæ—¶å€™å–æ¯”è¾ƒå¥½ï¼Ÿ",
            "answer": "..."
        },
        {
            "question": "è¿™æ¬¡ä¸Šæ¦œé è°±å—ï¼Ÿä¼šä¸ä¼šæ˜¯éª—ç‚®ï¼Ÿ",
            "answer": "..."
        }
    ]
  },
  "historical_context": {
    "chart_data": [
      { "date": "2024-07-15", "close": 10.0, "on_board": false },
      { "date": "2024-07-16", "close": 11.0, "on_board": true }
    ]
  }
}
``` 

